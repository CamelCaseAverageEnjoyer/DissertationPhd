'''
Файл сгененрирован программой PycharmProjects/PythonCompendium/DissertationPhd/advanced dynamic.ipynb (Раздел: Генерация файла H)
Копия файла из каталога PycharmProjects/PythonCompendium/DissertationPhd/storage/observability_mapping_partial_derivatives.py
'''
from numpy import sqrt, sin, cos, pi
import numpy as np

def h_element(i_x, i_y, i_n, i, j, i_all, j_all, fn, cn, relation, angles_navigation, r1, r2, r_f, q_f, multy_antenna_send: bool, multy_antenna_take: bool, w_0: float, t: float, q1: None, q2: None):
    '''Возвращает элемент матрицы Н в L_z^(c/d) строк и 6/13 столбцов.
    Столбец элемента матрицы H определяет только i_x. Остальные параметры определяют строку.
    :param i_x: Номер чипсата, у которого оценивается вектор-состояние (N вширь всей матрицы H)
    :param i_y: Номер чипсата/кубсата, от которого идёт сигнал (M / N(N-1) ввысь половины матрицы H)
    :param i_n: Номер чипсата, к которому идёт сигнал N ввысь элемента матрицы H^cf/H^ff)
    :param i: Номер 1-го КА
    :param j: Номер 2-го КА
    :param fn: Количество чипсатов
    :param cn: Количество кубсатов
    :param i_all: Количество антенн у 1-го КА
    :param j_all: Количество антенн у 2-го КА
    :param relation: Блок кубат-чипсат (cf) или чипсат-чипсат (ff) 
    :param angles_navigation: Оценивается ли вращательное движение
    :param r1: Положение 1-го КА
    :param r2: Положение 2-го КА
    :param r_f: Положения чипсатов
    :param q_f: Кватернионы ориентации чипсатов
    :param multy_antenna_send: Раскладывается ли сигнал при отправке
    :param multy_antenna_take: Раскладывается ли сигнал при принятии
    :param w_0: Угловая скорость вращения ОСК
    :param t: Текущее время
    :param q1: Кватернион 1-го КА (опционально)
    :param q2: Кватернион 2-го КА (опционально)
    '''

    ff_sequence = []  # Последовательность номеров непустых столбцов, длина ff_sequence - кол-во строк нижней подматицы
    for i_f1 in range(fn):
        for i_f2 in range(fn):
            if i_f1 != i_f2:
                ff_sequence += [[i_f1, i_f2]]

'''
Файл сгененрирован программой PycharmProjects/PythonCompendium/DissertationPhd/advanced dynamic.ipynb (Раздел: Генерация файла H)
Копия файла из каталога PycharmProjects/PythonCompendium/DissertationPhd/storage/observability_mapping_partial_derivatives.py
'''
from numpy import sqrt, sin, cos, pi
import numpy as np

def h_element(i_x, i_y, i_n, i, j, i_all, j_all, fn, cn, relation, angles_navigation, r1, r2, r_f, q_f, multy_antenna_send: bool, multy_antenna_take: bool, w_0: float, t: float, q1: None, q2: None):
    '''Возвращает элемент матрицы Н в L_z^(c/d) строк и 6/13 столбцов.
    Столбец элемента матрицы H определяет только i_x. Остальные параметры определяют строку.
    :param i_x: Номер чипсата, у которого оценивается вектор-состояние (N вширь всей матрицы H)
    :param i_y: Номер чипсата/кубсата, от которого идёт сигнал (M / N(N-1) ввысь половины матрицы H)
    :param i_n: Номер чипсата, к которому идёт сигнал N ввысь элемента матрицы H^cf/H^ff)
    :param i: Номер 1-го КА
    :param j: Номер 2-го КА
    :param fn: Количество чипсатов
    :param cn: Количество кубсатов
    :param i_all: Количество антенн у 1-го КА
    :param j_all: Количество антенн у 2-го КА
    :param relation: Блок кубат-чипсат (cf) или чипсат-чипсат (ff) 
    :param angles_navigation: Оценивается ли вращательное движение
    :param r1: Положение 1-го КА
    :param r2: Положение 2-го КА
    :param r_f: Положения чипсатов
    :param q_f: Кватернионы ориентации чипсатов
    :param multy_antenna_send: Раскладывается ли сигнал при отправке
    :param multy_antenna_take: Раскладывается ли сигнал при принятии
    :param w_0: Угловая скорость вращения ОСК
    :param t: Текущее время
    :param q1: Кватернион 1-го КА (опционально)
    :param q2: Кватернион 2-го КА (опционально)
    '''

    ff_sequence = []  # Последовательность номеров непустых столбцов, длина ff_sequence - кол-во строк нижней подматицы
    for i_f1 in range(fn):
        for i_f2 in range(i_f1):
            if i_f1 != i_f2:
                ff_sequence += [[i_f1, i_f2]]

    r1_x, r1_y, r1_z = r1
    r2_x, r2_y, r2_z = r2
    r12x = r1_x - r2_x
    r12y = r1_y - r2_y
    r12z = r1_z - r2_z
    r12 = sqrt(r12x**2 + r12y**2 + r12z**2)
    if q1 is not None:
        q1_0, q1_x, q1_y, q1_z = q1
    if q2 is not None:
        q2_0, q2_x, q2_y, q2_z = q2

    if angles_navigation:
        s1_11 = (2*q1_0*q1_z + 2*q1_x*q1_y)*cos(t*w_0) - (-2*q1_y**2 - 2*q1_z**2 + 1)*sin(t*w_0)
        s1_12 = -2*q1_0*q1_y + 2*q1_x*q1_z
        s1_13 = (2*q1_0*q1_z + 2*q1_x*q1_y)*sin(t*w_0) + (-2*q1_y**2 - 2*q1_z**2 + 1)*cos(t*w_0)
        s1_21 = -(-2*q1_0*q1_z + 2*q1_x*q1_y)*sin(t*w_0) + (-2*q1_x**2 - 2*q1_z**2 + 1)*cos(t*w_0)
        s1_22 = 2*q1_0*q1_x + 2*q1_y*q1_z
        s1_23 = (-2*q1_0*q1_z + 2*q1_x*q1_y)*cos(t*w_0) + (-2*q1_x**2 - 2*q1_z**2 + 1)*sin(t*w_0)
        s1_31 = (-2*q1_0*q1_x + 2*q1_y*q1_z)*cos(t*w_0) - (2*q1_0*q1_y + 2*q1_x*q1_z)*sin(t*w_0)
        s1_32 = -2*q1_x**2 - 2*q1_y**2 + 1
        s1_33 = (-2*q1_0*q1_x + 2*q1_y*q1_z)*sin(t*w_0) + (2*q1_0*q1_y + 2*q1_x*q1_z)*cos(t*w_0)
        s2_11 = (2*q2_0*q2_z + 2*q2_x*q2_y)*cos(t*w_0) - (-2*q2_y**2 - 2*q2_z**2 + 1)*sin(t*w_0)
        s2_12 = -2*q2_0*q2_y + 2*q2_x*q2_z
        s2_13 = (2*q2_0*q2_z + 2*q2_x*q2_y)*sin(t*w_0) + (-2*q2_y**2 - 2*q2_z**2 + 1)*cos(t*w_0)
        s2_21 = -(-2*q2_0*q2_z + 2*q2_x*q2_y)*sin(t*w_0) + (-2*q2_x**2 - 2*q2_z**2 + 1)*cos(t*w_0)
        s2_22 = 2*q2_0*q2_x + 2*q2_y*q2_z
        s2_23 = (-2*q2_0*q2_z + 2*q2_x*q2_y)*cos(t*w_0) + (-2*q2_x**2 - 2*q2_z**2 + 1)*sin(t*w_0)
        s2_31 = (-2*q2_0*q2_x + 2*q2_y*q2_z)*cos(t*w_0) - (2*q2_0*q2_y + 2*q2_x*q2_z)*sin(t*w_0)
        s2_32 = -2*q2_x**2 - 2*q2_y**2 + 1
        s2_33 = (-2*q2_0*q2_x + 2*q2_y*q2_z)*sin(t*w_0) + (2*q2_0*q2_y + 2*q2_x*q2_z)*cos(t*w_0)
        swt = sin(t*w_0)
        cwt = cos(t*w_0)
        s1_x_r12 = s1_11*(r12x) + s1_12*(r12y) + s1_13*(r12z)
        s1_y_r12 = s1_21*(r12x) + s1_22*(r12y) + s1_23*(r12z)
        s1_z_r12 = s1_31*(r12x) + s1_32*(r12y) + s1_33*(r12z)
        s2_x_r12 = s2_11*(r12x) + s2_12*(r12y) + s2_13*(r12z)
        s2_y_r12 = s2_21*(r12x) + s2_22*(r12y) + s2_23*(r12z)
        s2_z_r12 = s2_31*(r12x) + s2_32*(r12y) + s2_33*(r12z)
        s1_r12 = sqrt((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_z_r12)**2)
        s2_r12 = sqrt((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_z_r12)**2)
        s1_r12_2 = ((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_z_r12)**2)
        s2_r12_2 = ((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_z_r12)**2)

        s1_xyx = sqrt((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_x_r12)**2)
        s1_xy = sqrt((s1_x_r12)**2 + (s1_y_r12)**2)
        s1_yz = sqrt((s1_y_r12)**2 + (s1_z_r12)**2)
        s1_xz = sqrt((s1_x_r12)**2 + (s1_z_r12)**2)
        s2_xyx = sqrt((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_x_r12)**2)
        s2_xy = sqrt((s2_x_r12)**2 + (s2_y_r12)**2)
        s2_yz = sqrt((s2_y_r12)**2 + (s2_z_r12)**2)
        s2_xz = sqrt((s2_x_r12)**2 + (s2_z_r12)**2)

        s1_xyx_2 = ((s1_x_r12)**2 + (s1_y_r12)**2 + (s1_x_r12)**2)
        s1_xy_2 = ((s1_x_r12)**2 + (s1_y_r12)**2)
        s1_yz_2 = ((s1_y_r12)**2 + (s1_z_r12)**2)
        s1_xz_2 = ((s1_x_r12)**2 + (s1_z_r12)**2)
        s2_xyx_2 = ((s2_x_r12)**2 + (s2_y_r12)**2 + (s2_x_r12)**2)
        s2_xy_2 = ((s2_x_r12)**2 + (s2_y_r12)**2)
        s2_yz_2 = ((s2_y_r12)**2 + (s2_z_r12)**2)
        s2_xz_2 = ((s2_x_r12)**2 + (s2_z_r12)**2)

        c_s1_x = cos(pi*(s1_x_r12)/(2*s1_r12))
        c_s1_y = cos(pi*(s1_y_r12)/(2*s1_r12))
        c_s1_z = cos(pi*(s1_z_r12)/(2*s1_r12))
        c_s2_x = cos(pi*(s2_x_r12)/(2*s2_r12))
        c_s2_y = cos(pi*(s2_y_r12)/(2*s2_r12))
        c_s2_z = cos(pi*(s2_z_r12)/(2*s2_r12))


    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       [((-r12x)/r12)*int(i_n==j)*int(i_x==j), ((-r12y)/r12)*int(i_n==j)*int(i_x==j), ((-r12z)/r12)*int(i_n==j)*int(i_x==j), ] + 3*[0],
                       ])

    if (angles_navigation==False) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       [((r12x)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12x)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12y)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12y)/r12)*int(ff_sequence[i_y][1]==i_x), ((r12z)/r12)*int(ff_sequence[i_y][0]==i_x)+((-r12z)/r12)*int(ff_sequence[i_y][1]==i_x), ] + 3*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==False) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='cf'):
        return np.array([
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==False) and (relation=='ff'):
        return np.array([
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='cf'):
        return np.array([
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       [((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(i_n==j)*int(i_x==j), ] + 6*[0],
                       ])

    if (angles_navigation==True) and (i_all==1) and (j_all==1) and (multy_antenna_send==True) and (multy_antenna_take==True) and (relation=='ff'):
        return np.array([
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       [((r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(-s1_22) - 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) - 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(-s2_22) + 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (-2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (-2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) + 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12x)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_11/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/2 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_11/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/2 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/2 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(-s1_22) + 2*swt*(2*q1_0*q1_y + 2*q1_x*q1_z))*(s1_x_r12)/4 - (-2*cwt*(2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_y**2 - 2*q1_z**2 + 1))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_x**2 - 2*q1_z**2 + 1) + 2*swt*(-2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(-s2_22) - 2*swt*(2*q2_0*q2_y + 2*q2_x*q2_z))*(-s2_z_r12)/4 - (2*cwt*(2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_y**2 - 2*q2_z**2 + 1))*(-s2_x_r12)/4 - (2*cwt*(-2*q2_x**2 - 2*q2_z**2 + 1) - 2*swt*(-2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/2 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/2 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/2 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/2 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*q1_x + 4*q1_y*q1_z)*(s1_y_r12)/4 - (-4*q1_0*q1_y + 4*q1_x*q1_z)*(s1_x_r12)/4 - (-4*q1_x**2 - 4*q1_y**2 + 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-4*q2_0*q2_x - 4*q2_y*q2_z)*(-s2_y_r12)/4 - (4*q2_0*q2_y - 4*q2_x*q2_z)*(-s2_x_r12)/4 - (4*q2_x**2 + 4*q2_y**2 - 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12y)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_12/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/2 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/2 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_12/(2*s2_r12) + pi*(-s2_x_r12)*(-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/2 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/2 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*q1_x - 4*q1_y*q1_z)*(s1_y_r12)/4 - (4*q1_0*q1_y - 4*q1_x*q1_z)*(s1_x_r12)/4 - (4*q1_x**2 + 4*q1_y**2 - 2)*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(4*q2_0*q2_x + 4*q2_y*q2_z)*(-s2_y_r12)/4 - (-4*q2_0*q2_y + 4*q2_x*q2_z)*(-s2_x_r12)/4 - (-4*q2_x**2 - 4*q2_y**2 + 2)*(-s2_z_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/2 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (-pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/2 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) + 2*swt*(-s1_22))*(s1_x_r12)/4 - (2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) + 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) + 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(-2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) - 2*swt*(-s2_22))*(-s2_z_r12)/4 - (-2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) - 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (-2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) - 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][0]==i_x)+((-r12z)/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*r12*s1_xyx_2**(1/4)*s2_r12_2**(1/4)) + s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12*(-(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) - (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (-pi*s1_13/(2*s1_xyx) + pi*(s1_x_r12)*(-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/2 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/2 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*s2_13/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/2 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/2 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-2*cwt*(2*q1_0*q1_y + 2*q1_x*q1_z) - 2*swt*(-s1_22))*(s1_x_r12)/4 - (-2*cwt*(-2*q1_0*q1_z + 2*q1_x*q1_y) - 2*swt*(-2*q1_x**2 - 2*q1_z**2 + 1))*(s1_y_r12)/4 - (-2*cwt*(-2*q1_y**2 - 2*q1_z**2 + 1) - 2*swt*(2*q1_0*q1_z + 2*q1_x*q1_y))*(s1_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)) + (-(2*cwt*(2*q2_0*q2_y + 2*q2_x*q2_z) + 2*swt*(-s2_22))*(-s2_z_r12)/4 - (2*cwt*(-2*q2_0*q2_z + 2*q2_x*q2_y) + 2*swt*(-2*q2_x**2 - 2*q2_z**2 + 1))*(-s2_y_r12)/4 - (2*cwt*(-2*q2_y**2 - 2*q2_z**2 + 1) + 2*swt*(2*q2_0*q2_z + 2*q2_x*q2_y))*(-s2_x_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/2 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_z*(r12x) - 2*q1_y*(r12y) + 2*q1_z*swt*(r12z))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(-2*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 2*q1_x*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_z*(r12x) - 4*q1_y*(r12y) + 4*q1_z*swt*(r12z))/4 - (s1_y_r12)*(-4*cwt*q1_z*(r12z) + 4*q1_x*(r12y) + 4*q1_z*swt*(r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/2 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_z*(-r12x) - 2*q2_y*(-r12y) + 2*q2_z*swt*(-r12z))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(-2*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 2*q2_x*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_z*(-r12x) - 4*q2_y*(-r12y) + 4*q2_z*swt*(-r12z))/4 - (-s2_y_r12)*(-4*cwt*q2_z*(-r12z) + 4*q2_x*(-r12y) + 4*q2_z*swt*(-r12x))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(s1_x_r12)*(-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/2 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/2 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)) + pi*(2*cwt*q1_y*(r12x) + 2*q1_y*swt*(r12z) + 2*q1_z*(r12y))/(2*s1_xyx))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q1_0*(r12y) + 2*(r12x)*(-4*cwt*q1_x - 2*q1_y*swt) + 2*(r12z)*(2*cwt*q1_y - 4*q1_x*swt))*(s1_y_r12)/4 - (-8*q1_x*(r12y) + 2*(r12x)*(-2*cwt*q1_0 - 2*q1_z*swt) + 2*(r12z)*(2*cwt*q1_z - 2*q1_0*swt))*(s1_x_r12)/4 - (s1_x_r12)*(4*cwt*q1_y*(r12x) + 4*q1_y*swt*(r12z) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-s2_x_r12)*(-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/2 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/2 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)) + pi*(2*cwt*q2_y*(-r12x) + 2*q2_y*swt*(-r12z) + 2*q2_z*(-r12y))/(2*s2_r12))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(4*q2_0*(-r12y) + 2*(-r12x)*(-4*cwt*q2_x - 2*q2_y*swt) + 2*(-r12z)*(2*cwt*q2_y - 4*q2_x*swt))*(-s2_y_r12)/4 - (-8*q2_x*(-r12y) + 2*(-r12x)*(-2*cwt*q2_0 - 2*q2_z*swt) + 2*(-r12z)*(2*cwt*q2_z - 2*q2_0*swt))*(-s2_z_r12)/4 - (-s2_x_r12)*(4*cwt*q2_y*(-r12x) + 4*q2_y*swt*(-r12z) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(-2*q1_0*(r12y) + (r12x)*(2*cwt*q1_x + 4*q1_y*swt) + (r12z)*(-4*cwt*q1_y + 2*q1_x*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/2 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/2 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q1_0*(r12y) + 2*(r12x)*(2*cwt*q1_x + 4*q1_y*swt) + 2*(r12z)*(-4*cwt*q1_y + 2*q1_x*swt))*(s1_x_r12)/4 - (-8*q1_y*(r12y) + 2*(r12x)*(2*cwt*q1_z - 2*q1_0*swt) + 2*(r12z)*(2*cwt*q1_0 + 2*q1_z*swt))*(s1_x_r12)/4 - (s1_y_r12)*(4*cwt*q1_x*(r12z) - 4*q1_x*swt*(r12x) + 4*q1_z*(r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(-2*q2_0*(-r12y) + (-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + (-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/2 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/2 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(-4*q2_0*(-r12y) + 2*(-r12x)*(2*cwt*q2_x + 4*q2_y*swt) + 2*(-r12z)*(-4*cwt*q2_y + 2*q2_x*swt))*(-s2_x_r12)/4 - (-8*q2_y*(-r12y) + 2*(-r12x)*(2*cwt*q2_z - 2*q2_0*swt) + 2*(-r12z)*(2*cwt*q2_0 + 2*q2_z*swt))*(-s2_z_r12)/4 - (-s2_y_r12)*(4*cwt*q2_x*(-r12z) - 4*q2_x*swt*(-r12x) + 4*q2_z*(-r12y))/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ((-(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy_2**(3/2)*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)) + (pi*(2*q1_x*(r12y) + (r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + (r12z)*(-4*cwt*q1_z + 2*q1_0*swt))/(2*s1_xyx) + pi*(s1_x_r12)*(-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/2 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/2 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/2)/(2*s1_xyx_2**(3/2)))*sin(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(r12x)*(2*cwt*q1_y - 2*q1_x*swt) + 2*(r12z)*(2*cwt*q1_x + 2*q1_y*swt))*(s1_x_r12)/4 - (4*q1_x*(r12y) + 2*(r12x)*(2*cwt*q1_0 + 4*q1_z*swt) + 2*(r12z)*(-4*cwt*q1_z + 2*q1_0*swt))*(s1_x_r12)/4 - (4*q1_y*(r12y) + 2*(r12x)*(-4*cwt*q1_z + 2*q1_0*swt) + 2*(r12z)*(-2*cwt*q1_0 - 4*q1_z*swt))*(s1_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(5/4)*s2_r12_2**(1/4)))*int(ff_sequence[i_y][0]==i_x)+((-(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(2*s1_xy*((-s2_y_r12)**2 + (-s2_z_r12)**2)**(3/2)) + (pi*(2*q2_x*(-r12y) + (-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + (-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))/(2*s2_r12) + pi*(-s2_x_r12)*(-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/2 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/2 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/2)/(2*s2_r12_2**(3/2)))*sin(pi*(-s2_x_r12)/(2*s2_r12))*cos(pi*(s1_x_r12)/(2*s1_xyx))/(2*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(1/4)*cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))) + (-(2*(-r12x)*(2*cwt*q2_y - 2*q2_x*swt) + 2*(-r12z)*(2*cwt*q2_x + 2*q2_y*swt))*(-s2_z_r12)/4 - (4*q2_x*(-r12y) + 2*(-r12x)*(2*cwt*q2_0 + 4*q2_z*swt) + 2*(-r12z)*(-4*cwt*q2_z + 2*q2_0*swt))*(-s2_x_r12)/4 - (4*q2_y*(-r12y) + 2*(-r12x)*(-4*cwt*q2_z + 2*q2_0*swt) + 2*(-r12z)*(-2*cwt*q2_0 - 4*q2_z*swt))*(-s2_y_r12)/4)*r12/(sqrt(cos(pi*(s1_x_r12)/(2*s1_xyx))*cos(pi*(-s2_x_r12)/(2*s2_r12))/(s1_xy*sqrt((-s2_y_r12)**2 + (-s2_z_r12)**2)))*s1_xyx_2**(1/4)*s2_r12_2**(5/4)))*int(ff_sequence[i_y][1]==i_x), ] + 6*[0],
                       ])


def h_matrix(c_ant, f_ant, fn, cn, angles_navigation, r_f, r_c, multy_antenna_send: bool, multy_antenna_take: bool, w_0, t, q_f: None, q_c: None) -> np.ndarray:
    '''Возвращает матрицу частных производных Н.
    :param c_ant: Количество антенн у кубсата
    :param f_ant: Количество антенн у чипсата
    :param fn: Количество чипсатов
    :param cn: Количество кубсатов
    :param angles_navigation: Оценивается ли вращательное движение
    :param r_f: Положения чипсатов
    :param r_c: Положения кубсатов
    :param multy_antenna_send: Раскладывается ли сигнал при отправке
    :param multy_antenna_take: Раскладывается ли сигнал при принятии
    :param w_0: Угловая скорость вращения ОСК
    :param t: Текущее время
    :param q_f: Кватернионы чипсатов (опционально)
    :param q_c: Кватернионы кубсатов (опционально)
    :return: Матрица частных производных H. Отображение состояния в измерения
    '''
    ff_sequence = []  # Последовательность номеров непустых столбцов, длина ff_sequence - кол-во строк нижней подматицы
    for i_f1 in range(fn):
        for i_f2 in range(fn):
            if i_f1 != i_f2:
                ff_sequence += [[i_f1, i_f2]]
    cf_matrix = np.array([])
    ff_matrix = np.array([])
    for relation in ['cf', 'ff']:
        tmp_rows = None
        height = cn if relation=='cf' else int(fn*(fn-1)/2)
        for i_y in range(height):
            tmp_row = []
            for i_x in range(fn):
                tmp_row_col = []
                for i_f in range(fn if relation=='cf' else 1):
                    if relation == 'cf':
                        i_1 = i_y
                        i_2 = i_f
                    else:
                        i_1 = ff_sequence[i_y][0]
                        i_2 = ff_sequence[i_y][1]
                    tmp_row_col += [h_element(i_x=i_x, i_y=i_y, i_n=i_f, i=i_1, j=i_2, i_all=c_ant if relation=='cf' else f_ant, j_all=f_ant, fn=fn, cn=cn, relation=relation, angles_navigation=angles_navigation, r_f=r_f, r1=r_c[i_1] if relation=='cf' else r_f[i_1], r2=r_f[i_2], q_f=q_f, q1=q_c[i_1] if relation=='cf' else q_f[i_1], q2=q_f[i_2], multy_antenna_send=multy_antenna_send, multy_antenna_take=multy_antenna_take, w_0=w_0, t=t)]
                    
                tmp_row += [np.vstack(tmp_row_col)]
            
            tmp_row = np.bmat(tmp_row)
            tmp_rows = tmp_row if tmp_rows is None else np.vstack([tmp_rows, tmp_row])
        
        if relation == 'cf':
            cf_matrix = tmp_rows
        else:
            ff_matrix = tmp_rows
    
    # print('Верхняя подматрица: ' + str(cf_matrix.shape))
    if ff_matrix is not None:
        # print('Нижняя подматрица: ' + str(ff_matrix.shape))
        return np.vstack([cf_matrix, ff_matrix]), cf_matrix, ff_matrix
    return cf_matrix, cf_matrix, None
